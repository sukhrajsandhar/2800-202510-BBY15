<%- include('templates/header', { cssFiles: ['campsite-info.css']}) %>

<main style="display: flex; flex-direction: column; align-items: center">
    <div class="container mt-5" style="width: 80%">
        <!--Campsite Name and Saved Icon-->
        <div
            class="mb-3"
            style="
                display: flex;
                justify-content: space-between;
                align-items: center;
            "
        >
            <h1 style="color: #283f3b"><%= campsite.name %></h1>
            <div class="icon-container">
                <i
                    id="heart"
                    class="far fa-heart heart-icon"
                    style="margin: 1rem"
                ></i>
                <a href="/" class="back-link" style="margin: 1rem">
                    <i class="fas fa-arrow-left back-icon"></i>
                </a>
            </div>
        </div>
        <!--Campsite Card and Image-->
        <div class="mb-4" style="display: flex; gap: 1rem">
            <div class="card-body">
                <br />
                <h5>Description</h5>
                <p style="justify-content: center"><%= campsite.bio %></p>
                <h6>Address:</h6>
                <p><%= campsite.address %></p>
                <h6>Rating:</h6>
                <div id="starContainer" class="stars">
                    <p id="ratingValue"><%= campsite.rating %></p>
                </div>
            </div>
            <img
                src="<%= campsite.imageUrl %>"
                id="campsiteImage"
                class="img-fluid rounded-start"
                alt="..."
            />
        </div>
    </div>

    <!--Bookings Section-->
    <section
        style="
            width: 80%;

            margin-bottom: 2rem;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 1rem;
        "
    >
        <div
            style="
                display: flex;
                justify-content: space-between;
                align-items: center;
                margin-bottom: 1rem;
            "
        >
            <h2>Bookings</h2>
            <a
                href="/bookingAvailability"
                style="
                    background-color: #8212b6;
                    color: white;
                    padding: 0.5rem 1rem;
                    border-radius: 4px;
                    text-decoration: none;
                "
                >New Booking</a
            >
        </div>

        <!--Campsite specific scrollable bookings section-->
        <div class="card-container">
            <% bookings.forEach(function(bookings) { %>
            <div class="card">
                <h4><%= bookings.title %></h4>
                <small
                    ><%= bookings.dateStart %> to <%= bookings.dateEnd %></small
                >
                <p>Availability:</p>
                <small
                    >People: <%= bookings.tents %>, Tents: <%= bookings.people
                    %></small
                >
                <p><%= bookings.summary %></p>
                <a
                    href="#"
                    class="btn btn-secondary"
                    style="max-width: 20%; align-self: flex-end"
                    >Contact</a
                >
            </div>
            <% }) %>
        </div>
    </section>

    <!-- Reviews Section -->
    <section
        style="
            width: 80%;
            margin-bottom: 2rem;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 1rem;
        "
    >
        <div
            style="
                display: flex;
                justify-content: space-between;
                align-items: center;
                margin-bottom: 1rem;
            "
        >
            <h2>Reviews</h2>
            <a
                href="/createReview"
                style="
                    background-color: #4caf50;
                    color: white;
                    padding: 0.5rem 1rem;
                    border-radius: 4px;
                    text-decoration: none;
                "
                >New Review</a
            >
        </div>
        <div
            style="
                margin-bottom: 0.5rem;
                padding: 0.5rem;
                background-color: #f9f9f9;
                border-radius: 4px;
            "
        >
            <strong>User123:</strong> Beautiful spot! Lots of trees and quiet at
            night.
        </div>
        <div
            style="
                margin-bottom: 0.5rem;
                padding: 0.5rem;
                background-color: #f9f9f9;
                border-radius: 4px;
            "
        >
            <strong>CamperJane:</strong> Great hiking trails nearby and clean
            facilities.
        </div>
    </section>

    <!-- Alerts Section -->
    <section
        style="
            width: 80%;
            margin-bottom: 2rem;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 1rem;
        "
    >
        <div
            style="
                display: flex;
                justify-content: space-between;
                align-items: center;
                margin-bottom: 1rem;
            "
        >
            <h2>Alerts</h2>
            <a
                href="/createAlert"
                style="
                    background-color: #f44336;
                    color: white;
                    padding: 0.5rem 1rem;
                    border-radius: 4px;
                    text-decoration: none;
                "
                >New Alert</a
            >
        </div>
        <div
            style="
                margin-bottom: 0.5rem;
                padding: 0.5rem;
                background-color: #fff3cd;
                border-radius: 4px;
            "
        >
            <strong>Ranger Notice:</strong> Fire ban in effect until next week.
        </div>
        <div
            style="
                margin-bottom: 0.5rem;
                padding: 0.5rem;
                background-color: #fff3cd;
                border-radius: 4px;
            "
        >
            <strong>Weather Alert:</strong> Heavy rain expected tomorrow, pack
            accordingly.
        </div>
    </section>
</main>

<script>
    // Heart icon toggle functionality

    const heart = document.getElementById("heart");

    heart.addEventListener("click", () => {
        // Toggle between outlined (far) and solid (fas)
        if (heart.classList.contains("far")) {
            heart.classList.remove("far");
            heart.classList.add("fas");
        } else {
            heart.classList.remove("fas");
            heart.classList.add("far");
        }
    });

    // Star rating functionality

    const rating = parseFloat(
        document.getElementById("ratingValue").textContent
    );
    const starContainer = document.getElementById("starContainer");

    const fullStars = Math.floor(rating);
    const hasHalf = rating % 1 >= 0.25 && rating % 1 < 0.75;
    const emptyStars = 5 - fullStars - (hasHalf ? 1 : 0);

    for (let i = 0; i < fullStars; i++) {
        starContainer.innerHTML += '<i class="fas fa-star"></i>';
    }
    if (hasHalf) {
        starContainer.innerHTML += '<i class="fas fa-star-half-alt"></i>';
    }
    for (let i = 0; i < emptyStars; i++) {
        starContainer.innerHTML += '<i class="far fa-star"></i>';
    }

    // // Get the rating from the hidden div
    // const rating = parseInt(document.getElementById("ratingValue").textContent);
    // const clampedRating = Math.max(0, Math.min(5, rating)); // Clamp 0–5
    // const starContainer = document.getElementById("starContainer");

    // // Render the stars
    // starContainer.innerHTML = "★".repeat(clampedRating);
</script>

<%- include('templates/footer') %>
