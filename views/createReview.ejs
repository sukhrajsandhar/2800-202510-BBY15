<%- include("templates/header", { cssFiles: ['/styles.css', '/footer.css', '/reviews.css'] }) %>

        <div class="container" style="margin-top: 80px; margin-bottom: 100px;">
            <div class="card mx-auto" style="max-width: 500px; background-color: #D0DDD7;">
                <div class="card-header text-center" style="background-color: #95BF74;">
                    <h5 class="three mb-0"> üèïÔ∏è Review for <%= campsiteName %>
                    </h5>
                </div>
                <div class="card-body" style="max-height: 675px; overflow-y: auto;">
                    <form id="reviewForm">
                        <!-- Campsite name (placeholder) -->
                        <div class="mb-3">
                            <label class="form-label">Campsite Name</label>
                            <input type="text" class="form-control" placeholder="<%= campsiteName %>" disabled>
                        </div>

                        <!-- Overall rating -->
                        <div class="mb-3">
                            <label class="form-label">Overall Rating</label>
                            <select class="form-select" id="overallRating">
                                <option value="1">üåü‚òÜ‚òÜ‚òÜ‚òÜ</option>
                                <option value="2">üåüüåü‚òÜ‚òÜ‚òÜ</option>
                                <option value="3">üåüüåüüåü‚òÜ‚òÜ</option>
                                <option value="4">üåüüåüüåüüåü‚òÜ</option>
                                <option value="5">üåüüåüüåüüåüüåü</option>                                
                            </select>
                        </div>

                        <!-- Date visited -->
                        <div class="mb-3">
                            <label class="form-label">Date Visited</label>
                            <input type="date" class="form-control" id="dateVisited" value="2025-01-01">
                        </div>

                        <!-- Electricity/Water hookups -->
                        <div class="mb-3">
                            <label class="form-label">Electricity/Water Hookups</label>
                            <select class="form-select" id="electricityWaterHookups">
                                <option>Yes</option>
                                <option>No</option>
                            </select>
                        </div>

                        <!-- Dog Friendly -->
                        <div class="mb-3">
                            <label class="form-label">Dog Friendly</label>
                            <select class="form-select" id="dogFriendly">
                                <option>Yes</option>
                                <option>No</option>
                            </select>
                        </div>

                        <!-- Picnic tables -->
                        <div class="mb-3">
                            <label class="form-label">Picnic Tables</label>
                            <select class="form-select" id="picnicTables">
                                <option>Yes</option>
                                <option>No</option>
                            </select>
                        </div>

                        <!-- Fire pits/grills -->
                        <div class="mb-3">
                            <label class="form-label">Fire Pits/Grills</label>
                            <select class="form-select" id="firePitsGrills">
                                <option>Yes</option>
                                <option>No</option>
                            </select>
                        </div>

                        <!-- Cell service -->
                        <div class="mb-3">
                            <label class="form-label">Cell Service</label>
                            <select class="form-select" id="cellService">
                                <option>Yes</option>
                                <option>No</option>
                            </select>
                        </div>

                        <!-- Trash/Recycle bins -->
                        <div class="mb-3">
                            <label class="form-label">Trash/Recycle Bins</label>
                            <select class="form-select" id="trashRecycleBins">
                                <option>Yes</option>
                                <option>No</option>
                            </select>
                        </div>

                        <!-- Washrooms -->
                        <div class="mb-3">
                            <label class="form-label">Washrooms</label>
                            <select class="form-select" id="washrooms">
                                <option>Public</option>
                                <option>Portable</option>
                                <option>None</option>
                            </select>
                        </div>

                        <!-- Additional Comments -->
                        <div class="mb-3">
                            <label class="form-label">Additional Comments</label>
                            <textarea class="form-control" rows="3" id="additionalComments"
                                placeholder="Type your review details here..."></textarea>
                        </div>

                        <!-- Hidden campsiteId (ensure this is in your form) -->
                        <input type="hidden" id="campsiteId" value="<%= campsiteId %>">

                        <!-- Submit and Cancel buttons -->
                        <div class="d-grid gap-2 d-md-flex justify-content-md-between">
                            <a href="/campsite-info/<%= campsiteId %>" class="btn"
                                style="background-color: #95BF74; color: black;">Cancel</a>
                            <button type="submit" class="btn" style="background-color: #95BF74; color: black;">Submit
                                Review</button>
                        </div>
                    </form>
                </div>
            </div>
                <div class="wave-background-bottom">
  <svg viewBox="0 0 500 150" preserveAspectRatio="none">
    <path d="M0.00,49.98 C254.51,72.06 306.43,22.41 500.00,49.98 L500.00,150.00 L0.00,150.00 Z"></path>
  </svg>
</div>
    </div>
        <script>
            document.getElementById('reviewForm').addEventListener('submit', async (e) => {
                e.preventDefault();

                const formData = {
                    campsiteId: document.getElementById('campsiteId').value,
                    overallRating: document.getElementById('overallRating').value,
                    dateVisited: document.getElementById('dateVisited').value,
                    electricityWaterHookups: document.getElementById('electricityWaterHookups').value,
                    dogFriendly: document.getElementById('dogFriendly').value,
                    picnicTables: document.getElementById('picnicTables').value,
                    firePitsGrills: document.getElementById('firePitsGrills').value,
                    cellService: document.getElementById('cellService').value,
                    trashRecycleBins: document.getElementById('trashRecycleBins').value,
                    washrooms: document.getElementById('washrooms').value,
                    additionalComments: document.getElementById('additionalComments').value
                };

                try {
                    const response = await fetch('/api/reviews', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify(formData)
                    });

                    if (response.ok) {
                        const data = await response.json();
                        alert('Review submitted successfully!');
                        window.location.href = `/campsite-info/${data.campsiteId}`;
                    } else {
                        alert('Error submitting review. Please try again.');
                    }
                } catch (error) {
                    console.error('Error:', error);
                    alert('An error occurred. Please try again later.');
                }
            });
        </script>

        <%- include("templates/footer") %>